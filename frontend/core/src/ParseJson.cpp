#include "ParseJson.h"
#include <iostream>

Json::Value readJson(const std::string& rawJson) {
    // Get length of input
    const auto rawJsonLength = static_cast<int>(rawJson.length());
    JSONCPP_STRING err;
    Json::Value root;
    Json::CharReaderBuilder builder;
    const std::unique_ptr<Json::CharReader> reader(builder.newCharReader());

    if (!reader->parse(rawJson.c_str(), rawJson.c_str() + rawJsonLength, &root, &err)) {
        // Throw an exception
        throw std::domain_error("Error in parsing JSON input: String is not in correct JSON format.");
    }

    return root;
}

Json::Value getPieceRessources() {
    // Read pieces.json file.
    // std::ifstream piecesFile("../pieces.json");
    // std::stringstream buffer;
    // std::cout << "Fetched!\n";
    // buffer << piecesFile.rdbuf();

    // Parse to Json object.
    // return readJson(buffer.str());

    return readJson("{\"E\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":0,\"y\":-53.57},{\"x\":-21.28,\"y\":-104.95},{\"x\":-59.16,\"y\":-142.84}],\"rectangles\":[[{\"x\":19.617271543445117,\"y\":-3.893925678635703},{\"x\":-19.617271543445117,\"y\":3.893925678635703},{\"x\":-34.93199836812514,\"y\":-73.26038581266438},{\"x\":4.302544718765091,\"y\":-81.04823716993577}],[{\"x\":1.3242841926741669,\"y\":-88.25130713716594},{\"x\":-31.95373784203422,\"y\":-66.05731584543422},{\"x\":-75.68542082203427,\"y\":-131.62929389543422},{\"x\":-42.40739878732589,\"y\":-153.82328518716594}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":0,\"y\":1},\"type\":true,\"level\":0},{\"pos\":{\"x\":-59.16,\"y\":-142.84},\"direction\":{\"x\":-0.7070134522388871,\"y\":-0.7072000978176198},\"type\":false,\"level\":0}],\"id\":\"E\",\"name\":\"Large curve\",\"flip\":1,\"boundingCircle\":{\"x\":-20,\"y\":-75.5,\"radius\":83}},\"A\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":144,\"y\":0}],\"rectangles\":[[{\"x\":0,\"y\":20},{\"x\":0,\"y\":-20},{\"x\":144,\"y\":-20},{\"x\":144,\"y\":20}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":-1,\"y\":0},\"type\":true,\"level\":0},{\"pos\":{\"x\":144,\"y\":0},\"direction\":{\"x\":1,\"y\":0},\"type\":false,\"level\":0}],\"id\":\"A\",\"name\":\"Medium straight\",\"flip\":0,\"boundingCircle\":{\"x\":72,\"y\":0,\"radius\":77}},\"B\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":144,\"y\":0}],\"rectangles\":[[{\"x\":0,\"y\":20},{\"x\":0,\"y\":-20},{\"x\":144,\"y\":-20},{\"x\":144,\"y\":20}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":-1,\"y\":0},\"type\":true,\"level\":0},{\"pos\":{\"x\":144,\"y\":0},\"direction\":{\"x\":1,\"y\":0},\"type\":true,\"level\":0}],\"id\":\"B\",\"name\":\"Medium straight\",\"flip\":0,\"boundingCircle\":{\"x\":72,\"y\":0,\"radius\":77}},\"C\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":144,\"y\":0}],\"rectangles\":[[{\"x\":0,\"y\":20},{\"x\":0,\"y\":-20},{\"x\":144,\"y\":-20},{\"x\":144,\"y\":20}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":-1,\"y\":0},\"type\":false,\"level\":0},{\"pos\":{\"x\":144,\"y\":0},\"direction\":{\"x\":1,\"y\":0},\"type\":false,\"level\":0}],\"id\":\"C\",\"name\":\"Medium straight\",\"flip\":0,\"boundingCircle\":{\"x\":72,\"y\":0,\"radius\":77}},\"D\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":216,\"y\":0}],\"rectangles\":[[{\"x\":0,\"y\":20},{\"x\":0,\"y\":-20},{\"x\":216,\"y\":-20},{\"x\":216,\"y\":20}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":-1,\"y\":0},\"type\":true,\"level\":0},{\"pos\":{\"x\":216,\"y\":0},\"direction\":{\"x\":1,\"y\":0},\"type\":false,\"level\":0}],\"id\":\"D\",\"name\":\"Long straight\",\"flip\":0,\"boundingCircle\":{\"x\":108,\"y\":0,\"radius\":112}},\"A1\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":108,\"y\":0}],\"rectangles\":[[{\"x\":0,\"y\":20},{\"x\":0,\"y\":-20},{\"x\":108,\"y\":-20},{\"x\":108,\"y\":20}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":-1,\"y\":0},\"type\":true,\"level\":0},{\"pos\":{\"x\":108,\"y\":0},\"direction\":{\"x\":1,\"y\":0},\"type\":false,\"level\":0}],\"id\":\"A1\",\"name\":\"Short straight\",\"flip\":0,\"boundingCircle\":{\"x\":54,\"y\":0,\"radius\":60}},\"B1\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":108,\"y\":0}],\"rectangles\":[[{\"x\":0,\"y\":20},{\"x\":0,\"y\":-20},{\"x\":108,\"y\":-20},{\"x\":108,\"y\":20}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":-1,\"y\":0},\"type\":true,\"level\":0},{\"pos\":{\"x\":108,\"y\":0},\"direction\":{\"x\":1,\"y\":0},\"type\":true,\"level\":0}],\"id\":\"B1\",\"name\":\"Short straight\",\"flip\":0,\"boundingCircle\":{\"x\":54,\"y\":0,\"radius\":60}},\"C1\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":108,\"y\":0}],\"rectangles\":[[{\"x\":0,\"y\":20},{\"x\":0,\"y\":-20},{\"x\":108,\"y\":-20},{\"x\":108,\"y\":20}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":-1,\"y\":0},\"type\":false,\"level\":0},{\"pos\":{\"x\":108,\"y\":0},\"direction\":{\"x\":1,\"y\":0},\"type\":false,\"level\":0}],\"id\":\"C1\",\"name\":\"Short straight\",\"flip\":0,\"boundingCircle\":{\"x\":54,\"y\":0,\"radius\":60}},\"A2\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":54,\"y\":0}],\"rectangles\":[[{\"x\":0,\"y\":20},{\"x\":0,\"y\":-20},{\"x\":54,\"y\":-20},{\"x\":54,\"y\":20}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":-1,\"y\":0},\"type\":true,\"level\":0},{\"pos\":{\"x\":54,\"y\":0},\"direction\":{\"x\":1,\"y\":0},\"type\":false,\"level\":0}],\"id\":\"A2\",\"name\":\"Mini straight\",\"flip\":0,\"boundingCircle\":{\"x\":27,\"y\":0,\"radius\":35}},\"B2\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":54,\"y\":0}],\"rectangles\":[[{\"x\":0,\"y\":20},{\"x\":0,\"y\":-20},{\"x\":54,\"y\":-20},{\"x\":54,\"y\":20}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":-1,\"y\":0},\"type\":true,\"level\":0},{\"pos\":{\"x\":54,\"y\":0},\"direction\":{\"x\":1,\"y\":0},\"type\":true,\"level\":0}],\"id\":\"B2\",\"name\":\"Mini straight\",\"flip\":0,\"boundingCircle\":{\"x\":27,\"y\":0,\"radius\":35}},\"C2\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":54,\"y\":0}],\"rectangles\":[[{\"x\":0,\"y\":20},{\"x\":0,\"y\":-20},{\"x\":54,\"y\":-20},{\"x\":54,\"y\":20}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":-1,\"y\":0},\"type\":false,\"level\":0},{\"pos\":{\"x\":54,\"y\":0},\"direction\":{\"x\":1,\"y\":0},\"type\":false,\"level\":0}],\"id\":\"C2\",\"name\":\"Mini straight\",\"flip\":0,\"boundingCircle\":{\"x\":27,\"y\":0,\"radius\":35}},\"E1\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":0,\"y\":-29.17},{\"x\":-11.59,\"y\":-57.15},{\"x\":-32.22,\"y\":-77.78}],\"rectangles\":[[{\"x\":19.617135123940685,\"y\":-3.8946128856476436},{\"x\":-19.617135123940685,\"y\":3.8946128856476436},{\"x\":-27.958058571490696,\"y\":-38.118554310512394},{\"x\":11.276211676390671,\"y\":-45.90778008180769}],[{\"x\":8.297085216413679,\"y\":-53.11166563954728},{\"x\":-24.978932111513707,\"y\":-30.914668752772794},{\"x\":-48.79614578651373,\"y\":-66.6195895127728},{\"x\":-15.520128458586353,\"y\":-88.81658639954729}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":0,\"y\":1},\"type\":true,\"level\":0},{\"pos\":{\"x\":-32.22,\"y\":-77.78},\"direction\":{\"x\":-0.7071067811865475,\"y\":-0.7071067811865477},\"type\":false,\"level\":0}],\"id\":\"E1\",\"name\":\"Short curve\",\"flip\":1,\"boundingCircle\":{\"x\":-10,\"y\":-41,\"radius\":49}},\"M\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":0,\"y\":-53.57},{\"x\":-21.28,\"y\":-104.95},{\"x\":-59.16,\"y\":-142.84}],\"rectangles\":[[{\"x\":19.617271543445117,\"y\":-3.893925678635703},{\"x\":-19.617271543445117,\"y\":3.893925678635703},{\"x\":-34.93199836812514,\"y\":-73.26038581266438},{\"x\":4.302544718765091,\"y\":-81.04823716993577}],[{\"x\":1.3242841926741669,\"y\":-88.25130713716594},{\"x\":-31.95373784203422,\"y\":-66.05731584543422},{\"x\":-75.68542082203427,\"y\":-131.62929389543422},{\"x\":-42.40739878732589,\"y\":-153.82328518716594}]],\"level\":0},{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":0,\"y\":-144}],\"rectangles\":[[{\"x\":20,\"y\":0},{\"x\":-20,\"y\":0},{\"x\":-20,\"y\":-144},{\"x\":20,\"y\":-144}]],\"level\":0}],\"connectors\":[{\"pos\":{\"x\":-59.16,\"y\":-142.84},\"direction\":{\"x\":-0.7070134522388871,\"y\":-0.7072000978176198},\"type\":false,\"level\":0},{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":0,\"y\":1},\"type\":true,\"level\":0},{\"pos\":{\"x\":0,\"y\":-144},\"direction\":{\"x\":0,\"y\":-1},\"type\":false,\"level\":0}],\"id\":\"M\",\"name\":\"Curved switch\",\"flip\":2,\"boundingCircle\":{\"x\":-15,\"y\":-75.5,\"radius\":85}},\"N\":{\"parts\":[{\"bezierPoints\":[{\"x\":0,\"y\":0},{\"x\":108,\"y\":0}],\"rectangles\":[[{\"x\":0,\"y\":20},{\"x\":0,\"y\":-20},{\"x\":108,\"y\":-20},{\"x\":108,\"y\":20}]],\"level\":0},{\"bezierPoints\":[{\"x\":108,\"y\":0},{\"x\":216,\"y\":0}],\"rectangles\":[[{\"x\":108,\"y\":20},{\"x\":108,\"y\":-20},{\"x\":216,\"y\":-20},{\"x\":216,\"y\":20}]],\"level\":1}],\"connectors\":[{\"pos\":{\"x\":0,\"y\":0},\"direction\":{\"x\":-1,\"y\":0},\"type\":true,\"level\":0},{\"pos\":{\"x\":216,\"y\":0},\"direction\":{\"x\":1,\"y\":0},\"type\":false,\"level\":1}],\"id\":\"N\",\"name\":\"Ascending\",\"boundingCircle\":{\"x\":108,\"y\":0,\"radius\":110}}}");
}

std::string writeJson(const Json::Value& value) {
    Json::StreamWriterBuilder builder;
    // No whitespace in output
    builder["indentation"] = "";
    return Json::writeString(builder, value);
}
